var Sortable=function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1),s=(n.addons.classSet,n.addons.cloneWithProps);t.exports=n.createClass({displayName:"Sortable",propTypes:{onSort:n.PropTypes.func,horizontal:n.PropTypes.bool,sinkUndraggables:n.PropTypes.bool,floatUndraggables:n.PropTypes.bool},getDefaultProps:function(){return{onSort:function(){},horizontal:!1,sinkUndraggables:!1}},getInitialState:function(){return this.rerender(this.props.children),{isDragging:!1,placeHolderIndex:null,left:null,top:null}},componentWillReceiveProps:function(t){this.props.children!==t.children&&this.rerender(t.children)},rerender:function(t){this._firstDraggable=0,this._lastDraggable=n.Children.count(t)-1;var e=!1;this._orderArr=[],this._dimensionArr=t.map(function(t,i){return this.props.sinkUndraggables&&!t.props.isDraggable&&i<=this._lastDraggable&&!e?(this._lastDraggable=i-1,e=!0):this.props.floatUndraggables&&!t.props.isDraggable&&i>=this._firstDraggable&&(this._firstDraggable=i+1),this._orderArr.push(i),{}}.bind(this))},componentDidMount:function(){this.containerWidth=this.getDOMNode().offsetWidth,this.containerHeight=this.getDOMNode().offsetHeight},componentWillUnmount:function(){this.unbindEvent()},bindEvent:function(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)},unbindEvent:function(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},handleMouseDown:function(t,e){this._draggingIndex=e,this._prevX=t.pageX,this._prevY=t.pageY,this._initOffset=t.offset,this.bindEvent()},handleMouseMove:function(t){var e=this.calculateNewOffset(t),i=this.calculateNewIndex(t),n={isDragging:!0,top:e.top,left:e.left};-1!==i&&(this._draggingIndex=i,n.placeHolderIndex=i),this.setState(n),this._prevX=t.pageX,this._prevY=t.pageY},handleMouseUp:function(){this.unbindEvent(),this._draggingIndex=null,this._initOffset=null,this._prevX=null,this._prevY=null,this.state.isDragging&&this.props.onSort(this.getSortData()),this.isMounted()&&this.setState({isDragging:!1,placeHolderIndex:null,left:null,top:null})},handleChildUpdate:function(t,e,i,s){this._dimensionArr[s]=n.addons.update(this._dimensionArr[s],{top:{$set:t.top},left:{$set:t.left},width:{$set:e},height:{$set:i}})},getIndexByOffset:function(t,e){if(!t||!this.isNumeric(t.top)||!this.isNumeric(t.left))return-1;var i,n=t.left,s=t.top,r=null!==this.state.placeHolderIndex?this.state.placeHolderIndex:this._draggingIndex;return i=this.props.horizontal?this.getHorizontalIndexOffset(n,s,e):this.getVerticalIndexOffset(n,s,e),void 0!==i?i:r},getVerticalIndexOffset:function(t,e,i){var n,s=this._dimensionArr[this._dimensionArr.length-1];return this._dimensionArr.every(function(r,o){var a=t-r.left,h=e-r.top;return 0>e?(n=0,!1):e>this.containerHeight||e>s.top+s.height?(n=this._dimensionArr.length-1,!1):h<r.height&&a<r.width?(h<r.height/2&&"up"===i?n=o:h>r.height/2&&"down"===i&&(n=Math.min(o+1,this._dimensionArr.length-1)),!1):!0}.bind(this)),n},getHorizontalIndexOffset:function(t,e,i){var n,s=this._dimensionArr[this._dimensionArr.length-1];return this._dimensionArr.every(function(r,o){{var a=t-r.left;e-r.top}return 0>t?(n=0,!1):t>this.containerWidth||t>s.left+s.width?(n=this._dimensionArr.length-1,!1):a<r.width?(a<r.width/2&&"left"===i?n=o:a>r.width/2&&"right"===i&&(n=Math.min(o+1,this._dimensionArr.length-1)),!1):!0}.bind(this)),n},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},swapArrayItemPosition:function(t,e,i){if(!t||!this.isNumeric(e)||!this.isNumeric(i))return t;var n=t.splice(e,1)[0];return t.splice(i,0,n),t},calculateNewOffset:function(t){var e=this._prevX-t.pageX,i=this._prevY-t.pageY,n=null!==this.state.left?this.state.left:this._initOffset.left,s=null!==this.state.top?this.state.top:this._initOffset.top,r=n-e,o=s-i;return{left:r,top:o}},getPosition:function(){return{left:this.getDOMNode().offsetLeft,top:this.getDOMNode().offsetTop}},closest:function(t,e){return t&&(e(t)?t:this.closest(t.parentNode,e))},calculateNewIndex:function(t){var e,i=null!==this.state.placeHolderIndex?this.state.placeHolderIndex:this._draggingIndex,n=this.closest(t.target,function(t){return"undefined"==typeof t||"undefined"==typeof t.classList?!1:t.classList.contains("SortableItem")});n&&(e={left:n.offsetLeft,top:n.offsetTop});var s="";s=this.props.horizontal?this._prevX>t.pageX?"left":"right":this._prevY>t.pageY?"up":"down";var r=this.getIndexByOffset(e,s);return r<this._firstDraggable?(r=this._firstDraggable,this._draggingIndex<this._firstDraggable&&(r=this._firstDraggable-1,this._firstDraggable-=1)):r>this._lastDraggable&&(r=this._lastDraggable,this._draggingIndex>this._lastDraggable&&(r=this._lastDraggable+1,this._lastDraggable+=1)),-1!==r&&r!==i&&(this._dimensionArr=this.swapArrayItemPosition(this._dimensionArr,i,r),this._orderArr=this.swapArrayItemPosition(this._orderArr,i,r)),r},getSortData:function(){return this._orderArr.map(function(t){return this.props.children[t].props.sortData}.bind(this))},renderItems:function(){var t=[],e=(n.Children.count(this.props.children),this._orderArr.map(function(e,i){var n=this.props.children[e];return i===this._draggingIndex&&n.props.isDraggable&&t.push(this.renderDraggingItem(n)),s(n,{key:i,sortableClassNames:{SortableItem:!0},sortableIndex:i,onSortableItemMouseDown:function(t){this.handleMouseDown(t,i)}.bind(this),onSortableItemMount:this.handleChildUpdate})}.bind(this)));return e.concat(t)},renderDraggingItem:function(t){var e={top:this.state.top,left:this.state.left,width:this._dimensionArr[this._draggingIndex].width,height:this._dimensionArr[this._draggingIndex].height};return s(t,{sortableClassNames:{SortableItem:!0,"is-dragging":!0},key:this._dimensionArr.length,sortableStyle:e,isDragging:!0})},render:function(){return n.createElement("div",{className:"Sortable",ref:"movable"},this.renderItems())}})},function(t){t.exports=React}]);